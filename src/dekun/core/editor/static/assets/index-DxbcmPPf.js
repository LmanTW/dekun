(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function i(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerPolicy&&(n.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?n.credentials="include":a.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(a){if(a.ep)return;a.ep=!0;const n=i(a);fetch(a.href,n)}})();var ct,k,Ft,qt,N,Ct,Vt,Gt,Jt,St,gt,vt,V={},Zt=[],ye=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,ht=Array.isArray;function C(e,t){for(var i in t)e[i]=t[i];return e}function $t(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function ke(e,t,i){var s,a,n,r={};for(n in t)n=="key"?s=t[n]:n=="ref"?a=t[n]:r[n]=t[n];if(arguments.length>2&&(r.children=arguments.length>3?ct.call(arguments,2):i),typeof e=="function"&&e.defaultProps!=null)for(n in e.defaultProps)r[n]===void 0&&(r[n]=e.defaultProps[n]);return it(e,r,s,a,null)}function it(e,t,i,s,a){var n={type:e,props:t,key:i,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:a??++Ft,__i:-1,__u:0};return a==null&&k.vnode!=null&&k.vnode(n),n}function G(e){return e.children}function F(e,t){this.props=e,this.context=t}function U(e,t){if(t==null)return e.__?U(e.__,e.__i+1):null;for(var i;t<e.__k.length;t++)if((i=e.__k[t])!=null&&i.__e!=null)return i.__e;return typeof e.type=="function"?U(e):null}function Kt(e){var t,i;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((i=e.__k[t])!=null&&i.__e!=null){e.__e=e.__c.base=i.__e;break}return Kt(e)}}function Lt(e){(!e.__d&&(e.__d=!0)&&N.push(e)&&!nt.__r++||Ct!=k.debounceRendering)&&((Ct=k.debounceRendering)||Vt)(nt)}function nt(){for(var e,t,i,s,a,n,r,h=1;N.length;)N.length>h&&N.sort(Gt),e=N.shift(),h=N.length,e.__d&&(i=void 0,s=void 0,a=(s=(t=e).__v).__e,n=[],r=[],t.__P&&((i=C({},s)).__v=s.__v+1,k.vnode&&k.vnode(i),Tt(t.__P,i,s,t.__n,t.__P.namespaceURI,32&s.__u?[a]:null,n,a??U(s),!!(32&s.__u),r),i.__v=s.__v,i.__.__k[i.__i]=i,ee(n,i,r),s.__e=s.__=null,i.__e!=a&&Kt(i)));nt.__r=0}function Qt(e,t,i,s,a,n,r,h,_,c,f){var o,v,p,S,R,P,x,b=s&&s.__k||Zt,L=t.length;for(_=xe(i,t,b,_,L),o=0;o<L;o++)(p=i.__k[o])!=null&&(v=p.__i==-1?V:b[p.__i]||V,p.__i=o,P=Tt(e,p,v,a,n,r,h,_,c,f),S=p.__e,p.ref&&v.ref!=p.ref&&(v.ref&&Pt(v.ref,null,p),f.push(p.ref,p.__c||S,p)),R==null&&S!=null&&(R=S),(x=!!(4&p.__u))||v.__k===p.__k?_=te(p,_,e,x):typeof p.type=="function"&&P!==void 0?_=P:S&&(_=S.nextSibling),p.__u&=-7);return i.__e=R,_}function xe(e,t,i,s,a){var n,r,h,_,c,f=i.length,o=f,v=0;for(e.__k=new Array(a),n=0;n<a;n++)(r=t[n])!=null&&typeof r!="boolean"&&typeof r!="function"?(_=n+v,(r=e.__k[n]=typeof r=="string"||typeof r=="number"||typeof r=="bigint"||r.constructor==String?it(null,r,null,null,null):ht(r)?it(G,{children:r},null,null,null):r.constructor==null&&r.__b>0?it(r.type,r.props,r.key,r.ref?r.ref:null,r.__v):r).__=e,r.__b=e.__b+1,h=null,(c=r.__i=be(r,i,_,o))!=-1&&(o--,(h=i[c])&&(h.__u|=2)),h==null||h.__v==null?(c==-1&&(a>f?v--:a<f&&v++),typeof r.type!="function"&&(r.__u|=4)):c!=_&&(c==_-1?v--:c==_+1?v++:(c>_?v--:v++,r.__u|=4))):e.__k[n]=null;if(o)for(n=0;n<f;n++)(h=i[n])!=null&&(2&h.__u)==0&&(h.__e==s&&(s=U(h)),se(h,h));return s}function te(e,t,i,s){var a,n;if(typeof e.type=="function"){for(a=e.__k,n=0;a&&n<a.length;n++)a[n]&&(a[n].__=e,t=te(a[n],t,i,s));return t}e.__e!=t&&(s&&(t&&e.type&&!t.parentNode&&(t=U(e)),i.insertBefore(e.__e,t||null)),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function be(e,t,i,s){var a,n,r,h=e.key,_=e.type,c=t[i],f=c!=null&&(2&c.__u)==0;if(c===null&&e.key==null||f&&h==c.key&&_==c.type)return i;if(s>(f?1:0)){for(a=i-1,n=i+1;a>=0||n<t.length;)if((c=t[r=a>=0?a--:n++])!=null&&(2&c.__u)==0&&h==c.key&&_==c.type)return r}return-1}function Mt(e,t,i){t[0]=="-"?e.setProperty(t,i??""):e[t]=i==null?"":typeof i!="number"||ye.test(t)?i:i+"px"}function tt(e,t,i,s,a){var n,r;t:if(t=="style")if(typeof i=="string")e.style.cssText=i;else{if(typeof s=="string"&&(e.style.cssText=s=""),s)for(t in s)i&&t in i||Mt(e.style,t,"");if(i)for(t in i)s&&i[t]==s[t]||Mt(e.style,t,i[t])}else if(t[0]=="o"&&t[1]=="n")n=t!=(t=t.replace(Jt,"$1")),r=t.toLowerCase(),t=r in e||t=="onFocusOut"||t=="onFocusIn"?r.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+n]=i,i?s?i.u=s.u:(i.u=St,e.addEventListener(t,n?vt:gt,n)):e.removeEventListener(t,n?vt:gt,n);else{if(a=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=i??"";break t}catch{}typeof i=="function"||(i==null||i===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&i==1?"":i))}}function Ot(e){return function(t){if(this.l){var i=this.l[t.type+e];if(t.t==null)t.t=St++;else if(t.t<i.u)return;return i(k.event?k.event(t):t)}}}function Tt(e,t,i,s,a,n,r,h,_,c){var f,o,v,p,S,R,P,x,b,L,M,K,B,Et,Q,D,dt,E=t.type;if(t.constructor!=null)return null;128&i.__u&&(_=!!(32&i.__u),n=[h=t.__e=i.__e]),(f=k.__b)&&f(t);t:if(typeof E=="function")try{if(x=t.props,b="prototype"in E&&E.prototype.render,L=(f=E.contextType)&&s[f.__c],M=f?L?L.props.value:f.__:s,i.__c?P=(o=t.__c=i.__c).__=o.__E:(b?t.__c=o=new E(x,M):(t.__c=o=new F(x,M),o.constructor=E,o.render=Se),L&&L.sub(o),o.props=x,o.state||(o.state={}),o.context=M,o.__n=s,v=o.__d=!0,o.__h=[],o._sb=[]),b&&o.__s==null&&(o.__s=o.state),b&&E.getDerivedStateFromProps!=null&&(o.__s==o.state&&(o.__s=C({},o.__s)),C(o.__s,E.getDerivedStateFromProps(x,o.__s))),p=o.props,S=o.state,o.__v=t,v)b&&E.getDerivedStateFromProps==null&&o.componentWillMount!=null&&o.componentWillMount(),b&&o.componentDidMount!=null&&o.__h.push(o.componentDidMount);else{if(b&&E.getDerivedStateFromProps==null&&x!==p&&o.componentWillReceiveProps!=null&&o.componentWillReceiveProps(x,M),!o.__e&&o.shouldComponentUpdate!=null&&o.shouldComponentUpdate(x,o.__s,M)===!1||t.__v==i.__v){for(t.__v!=i.__v&&(o.props=x,o.state=o.__s,o.__d=!1),t.__e=i.__e,t.__k=i.__k,t.__k.some(function(X){X&&(X.__=t)}),K=0;K<o._sb.length;K++)o.__h.push(o._sb[K]);o._sb=[],o.__h.length&&r.push(o);break t}o.componentWillUpdate!=null&&o.componentWillUpdate(x,o.__s,M),b&&o.componentDidUpdate!=null&&o.__h.push(function(){o.componentDidUpdate(p,S,R)})}if(o.context=M,o.props=x,o.__P=e,o.__e=!1,B=k.__r,Et=0,b){for(o.state=o.__s,o.__d=!1,B&&B(t),f=o.render(o.props,o.state,o.context),Q=0;Q<o._sb.length;Q++)o.__h.push(o._sb[Q]);o._sb=[]}else do o.__d=!1,B&&B(t),f=o.render(o.props,o.state,o.context),o.state=o.__s;while(o.__d&&++Et<25);o.state=o.__s,o.getChildContext!=null&&(s=C(C({},s),o.getChildContext())),b&&!v&&o.getSnapshotBeforeUpdate!=null&&(R=o.getSnapshotBeforeUpdate(p,S)),D=f,f!=null&&f.type===G&&f.key==null&&(D=ie(f.props.children)),h=Qt(e,ht(D)?D:[D],t,i,s,a,n,r,h,_,c),o.base=t.__e,t.__u&=-161,o.__h.length&&r.push(o),P&&(o.__E=o.__=null)}catch(X){if(t.__v=null,_||n!=null)if(X.then){for(t.__u|=_?160:128;h&&h.nodeType==8&&h.nextSibling;)h=h.nextSibling;n[n.indexOf(h)]=null,t.__e=h}else{for(dt=n.length;dt--;)$t(n[dt]);yt(t)}else t.__e=i.__e,t.__k=i.__k,X.then||yt(t);k.__e(X,t,i)}else n==null&&t.__v==i.__v?(t.__k=i.__k,t.__e=i.__e):h=t.__e=we(i.__e,t,i,s,a,n,r,_,c);return(f=k.diffed)&&f(t),128&t.__u?void 0:h}function yt(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(yt)}function ee(e,t,i){for(var s=0;s<i.length;s++)Pt(i[s],i[++s],i[++s]);k.__c&&k.__c(t,e),e.some(function(a){try{e=a.__h,a.__h=[],e.some(function(n){n.call(a)})}catch(n){k.__e(n,a.__v)}})}function ie(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:ht(e)?e.map(ie):C({},e)}function we(e,t,i,s,a,n,r,h,_){var c,f,o,v,p,S,R,P=i.props,x=t.props,b=t.type;if(b=="svg"?a="http://www.w3.org/2000/svg":b=="math"?a="http://www.w3.org/1998/Math/MathML":a||(a="http://www.w3.org/1999/xhtml"),n!=null){for(c=0;c<n.length;c++)if((p=n[c])&&"setAttribute"in p==!!b&&(b?p.localName==b:p.nodeType==3)){e=p,n[c]=null;break}}if(e==null){if(b==null)return document.createTextNode(x);e=document.createElementNS(a,b,x.is&&x),h&&(k.__m&&k.__m(t,n),h=!1),n=null}if(b==null)P===x||h&&e.data==x||(e.data=x);else{if(n=n&&ct.call(e.childNodes),P=i.props||V,!h&&n!=null)for(P={},c=0;c<e.attributes.length;c++)P[(p=e.attributes[c]).name]=p.value;for(c in P)if(p=P[c],c!="children"){if(c=="dangerouslySetInnerHTML")o=p;else if(!(c in x)){if(c=="value"&&"defaultValue"in x||c=="checked"&&"defaultChecked"in x)continue;tt(e,c,null,p,a)}}for(c in x)p=x[c],c=="children"?v=p:c=="dangerouslySetInnerHTML"?f=p:c=="value"?S=p:c=="checked"?R=p:h&&typeof p!="function"||P[c]===p||tt(e,c,p,P[c],a);if(f)h||o&&(f.__html==o.__html||f.__html==e.innerHTML)||(e.innerHTML=f.__html),t.__k=[];else if(o&&(e.innerHTML=""),Qt(t.type=="template"?e.content:e,ht(v)?v:[v],t,i,s,b=="foreignObject"?"http://www.w3.org/1999/xhtml":a,n,r,n?n[0]:i.__k&&U(i,0),h,_),n!=null)for(c=n.length;c--;)$t(n[c]);h||(c="value",b=="progress"&&S==null?e.removeAttribute("value"):S!=null&&(S!==e[c]||b=="progress"&&!S||b=="option"&&S!=P[c])&&tt(e,c,S,P[c],a),c="checked",R!=null&&R!=e[c]&&tt(e,c,R,P[c],a))}return e}function Pt(e,t,i){try{if(typeof e=="function"){var s=typeof e.__u=="function";s&&e.__u(),s&&t==null||(e.__u=e(t))}else e.current=t}catch(a){k.__e(a,i)}}function se(e,t,i){var s,a;if(k.unmount&&k.unmount(e),(s=e.ref)&&(s.current&&s.current!=e.__e||Pt(s,null,t)),(s=e.__c)!=null){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(n){k.__e(n,t)}s.base=s.__P=null}if(s=e.__k)for(a=0;a<s.length;a++)s[a]&&se(s[a],t,i||typeof e.type!="function");i||$t(e.__e),e.__c=e.__=e.__e=void 0}function Se(e,t,i){return this.constructor(e,i)}function It(e,t,i){var s,a,n,r;t==document&&(t=document.documentElement),k.__&&k.__(e,t),a=(s=!1)?null:t.__k,n=[],r=[],Tt(t,e=t.__k=ke(G,null,[e]),a||V,V,t.namespaceURI,a?null:t.firstChild?ct.call(t.childNodes):null,n,a?a.__e:t.firstChild,s,r),ee(n,e,r)}ct=Zt.slice,k={__e:function(e,t,i,s){for(var a,n,r;t=t.__;)if((a=t.__c)&&!a.__)try{if((n=a.constructor)&&n.getDerivedStateFromError!=null&&(a.setState(n.getDerivedStateFromError(e)),r=a.__d),a.componentDidCatch!=null&&(a.componentDidCatch(e,s||{}),r=a.__d),r)return a.__E=a}catch(h){e=h}throw e}},Ft=0,qt=function(e){return e!=null&&e.constructor==null},F.prototype.setState=function(e,t){var i;i=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=C({},this.state),typeof e=="function"&&(e=e(C({},i),this.props)),e&&C(i,e),e!=null&&this.__v&&(t&&this._sb.push(t),Lt(this))},F.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),Lt(this))},F.prototype.render=G,N=[],Vt=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Gt=function(e,t){return e.__v.__b-t.__v.__b},nt.__r=0,Jt=/(PointerCapture)$|Capture$/i,St=0,gt=Ot(!1),vt=Ot(!0);var $e=0;function l(e,t,i,s,a,n){t||(t={});var r,h,_=t;if("ref"in _)for(h in _={},t)h=="ref"?r=t[h]:_[h]=t[h];var c={type:e,props:_,key:i,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--$e,__i:-1,__u:0,__source:a,__self:n};if(typeof e=="function"&&(r=e.defaultProps))for(h in r)_[h]===void 0&&(_[h]=r[h]);return k.vnode&&k.vnode(c),c}var at,$,_t,Nt,kt=0,ne=[],T=k,At=T.__b,Xt=T.__r,Yt=T.diffed,Ut=T.__c,zt=T.unmount,Ht=T.__;function ae(e,t){T.__h&&T.__h($,e,kt||t),kt=0;var i=$.__H||($.__H={__:[],__h:[]});return e>=i.__.length&&i.__.push({}),i.__[e]}function Te(e){return kt=1,Pe(re,e)}function Pe(e,t,i){var s=ae(at++,2);if(s.t=e,!s.__c&&(s.__=[re(void 0,t),function(h){var _=s.__N?s.__N[0]:s.__[0],c=s.t(_,h);_!==c&&(s.__N=[c,s.__[1]],s.__c.setState({}))}],s.__c=$,!$.__f)){var a=function(h,_,c){if(!s.__c.__H)return!0;var f=s.__c.__H.__.filter(function(v){return!!v.__c});if(f.every(function(v){return!v.__N}))return!n||n.call(this,h,_,c);var o=s.__c.props!==h;return f.forEach(function(v){if(v.__N){var p=v.__[0];v.__=v.__N,v.__N=void 0,p!==v.__[0]&&(o=!0)}}),n&&n.call(this,h,_,c)||o};$.__f=!0;var n=$.shouldComponentUpdate,r=$.componentWillUpdate;$.componentWillUpdate=function(h,_,c){if(this.__e){var f=n;n=void 0,a(h,_,c),n=f}r&&r.call(this,h,_,c)},$.shouldComponentUpdate=a}return s.__N||s.__}function Ie(e,t){var i=ae(at++,7);return Ce(i.__H,t)&&(i.__=e(),i.__H=t,i.__h=e),i.__}function Re(){for(var e;e=ne.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(st),e.__H.__h.forEach(xt),e.__H.__h=[]}catch(t){e.__H.__h=[],T.__e(t,e.__v)}}T.__b=function(e){$=null,At&&At(e)},T.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),Ht&&Ht(e,t)},T.__r=function(e){Xt&&Xt(e),at=0;var t=($=e.__c).__H;t&&(_t===$?(t.__h=[],$.__h=[],t.__.forEach(function(i){i.__N&&(i.__=i.__N),i.u=i.__N=void 0})):(t.__h.forEach(st),t.__h.forEach(xt),t.__h=[],at=0)),_t=$},T.diffed=function(e){Yt&&Yt(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(ne.push(t)!==1&&Nt===T.requestAnimationFrame||((Nt=T.requestAnimationFrame)||Ee)(Re)),t.__H.__.forEach(function(i){i.u&&(i.__H=i.u),i.u=void 0})),_t=$=null},T.__c=function(e,t){t.some(function(i){try{i.__h.forEach(st),i.__h=i.__h.filter(function(s){return!s.__||xt(s)})}catch(s){t.some(function(a){a.__h&&(a.__h=[])}),t=[],T.__e(s,i.__v)}}),Ut&&Ut(e,t)},T.unmount=function(e){zt&&zt(e);var t,i=e.__c;i&&i.__H&&(i.__H.__.forEach(function(s){try{st(s)}catch(a){t=a}}),i.__H=void 0,t&&T.__e(t,i.__v))};var Bt=typeof requestAnimationFrame=="function";function Ee(e){var t,i=function(){clearTimeout(s),Bt&&cancelAnimationFrame(t),setTimeout(e)},s=setTimeout(i,35);Bt&&(t=requestAnimationFrame(i))}function st(e){var t=$,i=e.__c;typeof i=="function"&&(e.__c=void 0,i()),$=t}function xt(e){var t=$;e.__c=e.__(),$=t}function Ce(e,t){return!e||e.length!==t.length||t.some(function(i,s){return i!==e[s]})}function re(e,t){return typeof t=="function"?t(e):t}var Le=Symbol.for("preact-signals");function ut(){if(O>1)O--;else{for(var e,t=!1;q!==void 0;){var i=q;for(q=void 0,bt++;i!==void 0;){var s=i.o;if(i.o=void 0,i.f&=-3,!(8&i.f)&&ce(i))try{i.c()}catch(a){t||(e=a,t=!0)}i=s}}if(bt=0,O--,t)throw e}}function Me(e){if(O>0)return e();O++;try{return e()}finally{ut()}}var y=void 0;function oe(e){var t=y;y=void 0;try{return e()}finally{y=t}}var q=void 0,O=0,bt=0,rt=0;function le(e){if(y!==void 0){var t=e.n;if(t===void 0||t.t!==y)return t={i:0,S:e,p:y.s,n:void 0,t:y,e:void 0,x:void 0,r:t},y.s!==void 0&&(y.s.n=t),y.s=t,e.n=t,32&y.f&&e.S(t),t;if(t.i===-1)return t.i=0,t.n!==void 0&&(t.n.p=t.p,t.p!==void 0&&(t.p.n=t.n),t.p=y.s,t.n=void 0,y.s.n=t,y.s=t),t}}function I(e,t){this.v=e,this.i=0,this.n=void 0,this.t=void 0,this.W=t?.watched,this.Z=t?.unwatched,this.name=t?.name}I.prototype.brand=Le;I.prototype.h=function(){return!0};I.prototype.S=function(e){var t=this,i=this.t;i!==e&&e.e===void 0&&(e.x=i,this.t=e,i!==void 0?i.e=e:oe(function(){var s;(s=t.W)==null||s.call(t)}))};I.prototype.U=function(e){var t=this;if(this.t!==void 0){var i=e.e,s=e.x;i!==void 0&&(i.x=s,e.e=void 0),s!==void 0&&(s.e=i,e.x=void 0),e===this.t&&(this.t=s,s===void 0&&oe(function(){var a;(a=t.Z)==null||a.call(t)}))}};I.prototype.subscribe=function(e){var t=this;return Z(function(){var i=t.value,s=y;y=void 0;try{e(i)}finally{y=s}},{name:"sub"})};I.prototype.valueOf=function(){return this.value};I.prototype.toString=function(){return this.value+""};I.prototype.toJSON=function(){return this.value};I.prototype.peek=function(){var e=y;y=void 0;try{return this.value}finally{y=e}};Object.defineProperty(I.prototype,"value",{get:function(){var e=le(this);return e!==void 0&&(e.i=this.i),this.v},set:function(e){if(e!==this.v){if(bt>100)throw new Error("Cycle detected");this.v=e,this.i++,rt++,O++;try{for(var t=this.t;t!==void 0;t=t.x)t.t.N()}finally{ut()}}}});function J(e,t){return new I(e,t)}function ce(e){for(var t=e.s;t!==void 0;t=t.n)if(t.S.i!==t.i||!t.S.h()||t.S.i!==t.i)return!0;return!1}function he(e){for(var t=e.s;t!==void 0;t=t.n){var i=t.S.n;if(i!==void 0&&(t.r=i),t.S.n=t,t.i=-1,t.n===void 0){e.s=t;break}}}function ue(e){for(var t=e.s,i=void 0;t!==void 0;){var s=t.p;t.i===-1?(t.S.U(t),s!==void 0&&(s.n=t.n),t.n!==void 0&&(t.n.p=s)):i=t,t.S.n=t.r,t.r!==void 0&&(t.r=void 0),t=s}e.s=i}function A(e,t){I.call(this,void 0),this.x=e,this.s=void 0,this.g=rt-1,this.f=4,this.W=t?.watched,this.Z=t?.unwatched,this.name=t?.name}A.prototype=new I;A.prototype.h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===rt))return!0;if(this.g=rt,this.f|=1,this.i>0&&!ce(this))return this.f&=-2,!0;var e=y;try{he(this),y=this;var t=this.x();(16&this.f||this.v!==t||this.i===0)&&(this.v=t,this.f&=-17,this.i++)}catch(i){this.v=i,this.f|=16,this.i++}return y=e,ue(this),this.f&=-2,!0};A.prototype.S=function(e){if(this.t===void 0){this.f|=36;for(var t=this.s;t!==void 0;t=t.n)t.S.S(t)}I.prototype.S.call(this,e)};A.prototype.U=function(e){if(this.t!==void 0&&(I.prototype.U.call(this,e),this.t===void 0)){this.f&=-33;for(var t=this.s;t!==void 0;t=t.n)t.S.U(t)}};A.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var e=this.t;e!==void 0;e=e.x)e.t.N()}};Object.defineProperty(A.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var e=le(this);if(this.h(),e!==void 0&&(e.i=this.i),16&this.f)throw this.v;return this.v}});function Dt(e,t){return new A(e,t)}function de(e){var t=e.u;if(e.u=void 0,typeof t=="function"){O++;var i=y;y=void 0;try{t()}catch(s){throw e.f&=-2,e.f|=8,Rt(e),s}finally{y=i,ut()}}}function Rt(e){for(var t=e.s;t!==void 0;t=t.n)t.S.U(t);e.x=void 0,e.s=void 0,de(e)}function Oe(e){if(y!==this)throw new Error("Out-of-order effect");ue(this),y=e,this.f&=-2,8&this.f&&Rt(this),ut()}function z(e,t){this.x=e,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32,this.name=t?.name}z.prototype.c=function(){var e=this.S();try{if(8&this.f||this.x===void 0)return;var t=this.x();typeof t=="function"&&(this.u=t)}finally{e()}};z.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,de(this),he(this),O++;var e=y;return y=this,Oe.bind(this,e)};z.prototype.N=function(){2&this.f||(this.f|=2,this.o=q,q=this)};z.prototype.d=function(){this.f|=8,1&this.f||Rt(this)};z.prototype.dispose=function(){this.d()};function Z(e,t){var i=new z(e,t);try{i.c()}catch(a){throw i.d(),a}var s=i.d.bind(i);return s[Symbol.dispose]=s,s}var _e,pt,pe=[];Z(function(){_e=this.N})();function H(e,t){k[e]=t.bind(null,k[e]||function(){})}function ot(e){pt&&pt(),pt=e&&e.S()}function fe(e){var t=this,i=e.data,s=Ae(i);s.value=i;var a=Ie(function(){for(var h=t,_=t.__v;_=_.__;)if(_.__c){_.__c.__$f|=4;break}var c=Dt(function(){var p=s.value.value;return p===0?0:p===!0?"":p||""}),f=Dt(function(){return!Array.isArray(c.value)&&!qt(c.value)}),o=Z(function(){if(this.N=me,f.value){var p=c.value;h.__v&&h.__v.__e&&h.__v.__e.nodeType===3&&(h.__v.__e.data=p)}}),v=t.__$u.d;return t.__$u.d=function(){o(),v.call(this)},[f,c]},[]),n=a[0],r=a[1];return n.value?r.peek():r.value}fe.displayName="ReactiveTextNode";Object.defineProperties(I.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:fe},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}});H("__b",function(e,t){if(typeof t.type=="function"&&typeof window<"u"&&window.__PREACT_SIGNALS_DEVTOOLS__&&window.__PREACT_SIGNALS_DEVTOOLS__.exitComponent(),typeof t.type=="string"){var i,s=t.props;for(var a in s)if(a!=="children"){var n=s[a];n instanceof I&&(i||(t.__np=i={}),i[a]=n,s[a]=n.peek())}}e(t)});H("__r",function(e,t){if(typeof t.type=="function"&&typeof window<"u"&&window.__PREACT_SIGNALS_DEVTOOLS__&&window.__PREACT_SIGNALS_DEVTOOLS__.enterComponent(t.type.displayName||t.type.name||"Unknown"),t.type!==G){ot();var i,s=t.__c;s&&(s.__$f&=-2,(i=s.__$u)===void 0&&(s.__$u=i=(function(a){var n;return Z(function(){n=this}),n.c=function(){s.__$f|=1,s.setState({})},n})())),ot(i)}e(t)});H("__e",function(e,t,i,s){typeof window<"u"&&window.__PREACT_SIGNALS_DEVTOOLS__&&window.__PREACT_SIGNALS_DEVTOOLS__.exitComponent(),ot(),e(t,i,s)});H("diffed",function(e,t){typeof t.type=="function"&&typeof window<"u"&&window.__PREACT_SIGNALS_DEVTOOLS__&&window.__PREACT_SIGNALS_DEVTOOLS__.exitComponent(),ot();var i;if(typeof t.type=="string"&&(i=t.__e)){var s=t.__np,a=t.props;if(s){var n=i.U;if(n)for(var r in n){var h=n[r];h!==void 0&&!(r in s)&&(h.d(),n[r]=void 0)}else n={},i.U=n;for(var _ in s){var c=n[_],f=s[_];c===void 0?(c=Ne(i,_,f,a),n[_]=c):c.o(f,a)}}}e(t)});function Ne(e,t,i,s){var a=t in e&&e.ownerSVGElement===void 0,n=J(i);return{o:function(r,h){n.value=r,s=h},d:Z(function(){this.N=me;var r=n.value.value;s[t]!==r&&(s[t]=r,a?e[t]=r:r?e.setAttribute(t,r):e.removeAttribute(t))})}}H("unmount",function(e,t){if(typeof t.type=="string"){var i=t.__e;if(i){var s=i.U;if(s){i.U=void 0;for(var a in s){var n=s[a];n&&n.d()}}}}else{var r=t.__c;if(r){var h=r.__$u;h&&(r.__$u=void 0,h.d())}}e(t)});H("__h",function(e,t,i,s){(s<3||s===9)&&(t.__$f|=2),e(t,i,s)});F.prototype.shouldComponentUpdate=function(e,t){var i=this.__$u,s=i&&i.s!==void 0;for(var a in t)return!0;if(this.__f||typeof this.u=="boolean"&&this.u===!0){var n=2&this.__$f;if(!(s||n||4&this.__$f)||1&this.__$f)return!0}else if(!(s||4&this.__$f)||3&this.__$f)return!0;for(var r in e)if(r!=="__source"&&e[r]!==this.props[r])return!0;for(var h in this.props)if(!(h in e))return!0;return!1};function Ae(e,t){return Te(function(){return J(e,t)})[0]}var Xe=function(e){queueMicrotask(function(){queueMicrotask(e)})};function Ye(){Me(function(){for(var e;e=pe.shift();)_e.call(e)})}function me(){pe.push(this)===1&&(k.requestAnimationFrame||Xe)(Ye)}const Ue={id:"nhentai",name:"nHentai"},ze=Object.freeze(Object.defineProperty({__proto__:null,default:Ue},Symbol.toStringTag,{value:"Module"}));let w=null;const Y=[];async function Wt(){const e=(await(await fetch("/api/drivers/pixiv/discovery")).json()).body.illusts,t=e[Math.floor(Math.random()*e.length)],i=(await(await fetch(`/api/drivers/pixiv/pages/${t.id}`)).json()).body,s=Math.floor(Math.random()*t.pageCount),a=i[s].urls.original.split("/");return{id:`${t.id}`,page:s+1,url:`/resource/pixiv/${a.slice(5,11).join("-")}/${a[11]}`,source:`${t.id}/${s+1}`}}const He={id:"pixiv",name:"Pixiv",async next(e){const t=e.split("/").map(i=>i.trim()).filter(i=>i.length>0);if(t.length>0){if(w===null||t[0]!==w.id)w={id:t[0],pages:(await(await fetch(`/api/drivers/pixiv/pages/${t[0]}`)).json()).body.map(i=>{const s=i.urls.original.split("/");return`/resource/pixiv/${s.slice(5,11).join("-")}/${s[11]}`}),index:t.length>1?parseInt(t[1])-1:0,cacheIndex:t.length>1?parseInt(t[1])-1:0};else{const i=isNaN(parseInt(t[1]))?1:parseInt(t[1])-1;w.index=i===w.index?w.index+1:i}return w.index>=w.pages.length?(w=null,await this.next("")):{id:w.id,page:w.index+1,url:w.pages[w.index],source:`${w.id}/${w.index+1}`}}return Y.length>0?Object.assign(Y.splice(0,1)[0],{source:""}):Object.assign(await Wt(),{source:""})},preload:async e=>{if(w===null){if(Y.length<e){const t=Y[Y.push(await Wt())-1];return{id:t.id,page:t.page,url:t.url,amount:Y.length}}}else if(w.cacheIndex<Math.min(w.index+e,w.pages.length))return w.cacheIndex++,{id:w.id,page:w.cacheIndex,url:w.pages[w.cacheIndex-1],amount:w.cacheIndex-w.index};return null}},Be=Object.freeze(Object.defineProperty({__proto__:null,default:He},Symbol.toStringTag,{value:"Module"})),jt=Object.assign({"./drivers/nhentai.ts":ze,"./drivers/pixiv.ts":Be});class m{static canvas=document.createElement("canvas");static ctx=this.canvas.getContext("2d");static submitCanvas=document.createElement("canvas");static submitCtx=this.submitCanvas.getContext("2d");static drivers={pixiv:jt["./drivers/pixiv.ts"].default,nhentai:jt["./drivers/nhentai.ts"].default};static data=null;static timestamp=0;static async next(t){const i=this.data,s=performance.now();this.data=null,this.timestamp=performance.now();try{const a=d.source.driver,n=await this.drivers[d.source.driver].next(t===void 0?d.source.value:t);if(n===null)this.data=i;else{d.updateSource({value:n.source,display:`${n.id}/${n.page}`});const r=document.createElement("img");r.src=n.url,r.addEventListener("load",()=>{this.timestamp===s&&(this.data={provider:a,id:n.id,page:n.page,element:r,transform:this.calculateTransform(r.width,r.height),strokes:[]},this.canvas.width=r.width,this.canvas.height=r.height)})}}catch{this.data=i}}static async submit(){if(this.data!==null){const t=this.data;this.data=null,g.reset(),u.reset();const i=this.submitCanvas,s=this.submitCtx;i.width=t.element.width,i.height=t.element.height,s.fillStyle="white",s.strokeStyle="white";for(const r of t.strokes)if(r.type===1||r.type===2)s.lineCap=r.type===1?"butt":"round",s.lineWidth=(t.element.width+t.element.height)*(r.size*.0025),s.moveTo(r.x1,r.y1),s.lineTo(r.x2,r.y2),s.stroke(),s.beginPath();else if(r.type===3){for(const[h,_]of r.points.entries())h===0?s.moveTo(_.x,_.y):s.lineTo(_.x,_.y);s.lineTo(r.points[0].x,r.points[0].y),s.fill(),s.beginPath()}const a=i.toDataURL("image/png",1).substring(22);s.clearRect(0,0,i.width,i.height),s.imageSmoothingEnabled=!1,s.drawImage(t.element,0,0,i.width,i.height);const n=i.toDataURL("image/jpeg",1).substring(23);try{await fetch("/api/submit",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:t.provider,id:t.id,page:t.page,image:n,mask:a,author:d.settings.username})}),await this.next()}catch{this.data=t}}}static update(){if(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.imageSmoothingEnabled=!1,this.data!==null){this.ctx.fillStyle=`rgba(0,255,0,${u.strokeOpacity})`,this.ctx.strokeStyle=`rgba(0,255,0,${u.strokeOpacity})`;for(const t of this.data.strokes)if(t.type===1||t.type===2)this.ctx.lineCap=t.type===1?"butt":"round",this.ctx.lineWidth=(this.data.element.width+this.data.element.height)*(t.size*.0025),this.ctx.moveTo(t.x1,t.y1),this.ctx.lineTo(t.x2,t.y2),this.ctx.stroke(),this.ctx.beginPath();else if(t.type===3){for(const[i,s]of t.points.entries())i===0?this.ctx.moveTo(s.x,s.y):this.ctx.lineTo(s.x,s.y);this.ctx.lineTo(t.points[0].x,t.points[0].y),this.ctx.fill(),this.ctx.beginPath()}if(this.ctx.fillStyle="rgba(0,255,0,0.5)",this.ctx.strokeStyle="rgba(0,255,0,0.5)",u.strokeType===1||u.strokeType===2)u.startX!==null&&u.startY!==null&&(this.ctx.lineCap=u.strokeType===1?"butt":"round",this.ctx.lineWidth=(this.data.element.width+this.data.element.height)*(u.strokeSize*.0025),this.ctx.moveTo(u.startX,u.startY),this.ctx.lineTo(u.mouse.imageX,u.mouse.imageY),this.ctx.stroke(),this.ctx.beginPath());else if(u.strokeType===3){for(const[t,i]of u.strokePoints.entries())t===0?this.ctx.moveTo(i.x,i.y):this.ctx.lineTo(i.x,i.y);u.strokePoints.length>2&&this.ctx.lineTo(u.strokePoints[0].x,u.strokePoints[0].y),this.ctx.fill(),this.ctx.beginPath()}}}static async preload(){return await m.drivers[d.source.driver].preload(d.settings.preload)}static updateTransform(){this.data!==null&&(this.data.transform=this.calculateTransform(this.data.element.width,this.data.element.height))}static calculateTransform(t,i){const s=g.canvas.width/g.canvas.height,a=t/i;let n,r;a>s?(n=g.canvas.width,r=g.canvas.width/a):(n=g.canvas.height*a,r=g.canvas.height);const h=3.5*parseFloat(getComputedStyle(document.documentElement).fontSize)*d.settings.resolution;return n*=.9,r*=.9,r-=h/2,{x:(g.canvas.width-n)/2,y:(g.canvas.height+h-r)/2,width:n,height:r,widthScale:n/t,heightScale:r/i}}}function ge(e,t){return localStorage.hasOwnProperty(e)?JSON.parse(localStorage.getItem(e)):t}const et=J({help:!1,settings:!1,tasks:!1,entries:!1}),W=J(ge("settings",{username:"unknown",fps:0,resolution:window.devicePixelRatio,preload:5,moveSpeed:1,scaleSpeed:1,reduceTransparency:!1})),j=J(ge("source",{driver:Object.keys(m.drivers)[0],value:"",display:""}));class d{static get layout(){return et.value}static get settings(){return W.value}static get source(){return j.value}static get layoutSignal(){return et}static get settingsSignal(){return W}static get sourceSignal(){return j}static updateLayout(t){et.value={...et.value,...t}}static updateSettings(t){W.value={...W.value,...t},localStorage.setItem("settings",JSON.stringify(W.value))}static updateSource(t){j.value={...j.value,...t},localStorage.setItem("source",JSON.stringify(j.value))}}class u{static mouse={button:{left:0,right:0},editorX:0,editorY:0,imageX:0,imageY:0,oldImageX:0,oldImageY:0};static keyboard=new Map;static strokeType=1;static strokeSize=2;static strokePoints=[];static startX=null;static startY=null;static moveIndex=null;static strokeOpacity=1;static saveConfirm=0;static reset(){this.strokePoints=[],this.startX=null,this.startY=null,this.moveIndex=null}static update(t){if(m.data!==null)if(u.mouse.oldImageX=this.mouse.imageX,u.mouse.oldImageY=this.mouse.imageY,u.mouse.imageX=(this.mouse.editorX/g.camera.scale+(g.camera.x-m.data.transform.x))/m.data.transform.widthScale,u.mouse.imageY=(this.mouse.editorY/g.camera.scale+(g.camera.y-m.data.transform.y))/m.data.transform.heightScale,this.mouse.button.left===1){if(this.strokeType==1||this.strokeType===2)this.startX=this.mouse.imageX,this.startY=this.mouse.imageY;else if(this.strokeType===3){for(let i=0;i<this.strokePoints.length;i++){const s=(m.data.transform.x+u.strokePoints[i].x*m.data.transform.widthScale-g.camera.x)*g.camera.scale,a=(m.data.transform.y+u.strokePoints[i].y*m.data.transform.heightScale-g.camera.y)*g.camera.scale;if(Math.hypot(s-this.mouse.editorX,a-this.mouse.editorY)<7.5*d.settings.resolution){this.moveIndex=i;break}}this.moveIndex===null&&this.strokePoints.push({x:this.mouse.imageX,y:this.mouse.imageY})}}else if(this.mouse.button.right===1){if(this.strokeType===1||this.strokeType===2){const i=m.data.strokes[m.data.strokes.length-1];i!==void 0&&i.type===this.strokeType&&(this.startX=i.x2,this.startY=i.y2)}else if(this.strokeType===3)if(this.strokePoints.length===0){const i=m.data.strokes[m.data.strokes.length-1];i!==void 0&&i.type===3&&(this.strokePoints=i.points,m.data.strokes.splice(m.data.strokes.length-1,1))}else this.strokePoints.length>2&&m.data.strokes.push({type:3,points:this.strokePoints}),this.strokePoints=[]}else this.mouse.button.left===2?this.moveIndex!==null&&(this.strokePoints[this.moveIndex]={x:this.mouse.imageX,y:this.mouse.imageY}):(this.mouse.button.left===3||this.mouse.button.right===3)&&((this.strokeType===1||this.strokeType===2)&&this.startX!==null&&this.startY!==null?(m.data.strokes.push({type:this.strokeType,size:this.strokeSize,x1:this.startX,y1:this.startY,x2:this.mouse.imageX,y2:this.mouse.imageY}),this.startX=null,this.startY=null):this.strokeType===3&&(this.moveIndex=null));this.keyboard.get("Escape")===1?this.reset():this.keyboard.get("1")===1?(this.strokeType=1,this.strokePoints=[]):this.keyboard.get("2")===1?(this.strokeType=2,this.strokePoints=[]):this.keyboard.get("3")===1&&(this.strokeType=3,this.startX=null,this.startY=null),this.keyboard.get("-")===1?(u.strokeSize-=1,u.strokeSize=Math.min(100/g.camera.scale,Math.max(.5/g.camera.scale,u.strokeSize))):this.keyboard.get("=")===1&&(u.strokeSize+=1,u.strokeSize=Math.min(100/g.camera.scale,Math.max(.5/g.camera.scale,u.strokeSize))),this.keyboard.has("a")?g.camera.xSpeed=-3*d.settings.moveSpeed:this.keyboard.has("d")&&(g.camera.xSpeed=3*d.settings.moveSpeed),this.keyboard.has("w")?g.camera.ySpeed=-3*d.settings.moveSpeed:this.keyboard.has("s")&&(g.camera.ySpeed=3*d.settings.moveSpeed),this.keyboard.has("q")?g.camera.scaleSpeed=-.005*d.settings.scaleSpeed:this.keyboard.has("e")&&(g.camera.scaleSpeed=.005*d.settings.scaleSpeed),this.keyboard.get("r")===1?g.reset():this.keyboard.get("f")===1&&(this.strokeOpacity-=.5,this.strokeOpacity<0&&(this.strokeOpacity=1)),this.keyboard.get("z")===1?m.next():this.keyboard.get("x")===1&&(this.strokePoints.length>0?this.strokePoints.splice(this.strokePoints.length-1):m.data!==null&&m.data.strokes.length>0&&m.data.strokes.splice(m.data.strokes.length-1)),m.data!==null&&(this.keyboard.has("c")?(this.saveConfirm+=.003*t,this.saveConfirm>1&&(m.submit(),this.saveConfirm=0)):this.saveConfirm=0),this.mouse.button.left===1?this.mouse.button.left=2:this.mouse.button.left===3&&(this.mouse.button.left=0),this.mouse.button.right===1?this.mouse.button.right=2:this.mouse.button.right===3&&(this.mouse.button.right=0),this.keyboard.forEach((i,s)=>{this.keyboard.set(s,2)})}}window.addEventListener("mousedown",e=>{e.target===g.canvas&&(e.button===0?u.mouse.button.left=1:e.button===2&&(u.mouse.button.right=1))});window.addEventListener("mouseup",e=>{e.button===0?u.mouse.button.left=3:e.button===2&&(u.mouse.button.right=3)});window.addEventListener("mousemove",e=>{u.mouse.editorX=e.x*d.settings.resolution,u.mouse.editorY=e.y*d.settings.resolution});window.addEventListener("wheel",e=>{e.target===g.canvas&&(u.strokeSize+=-e.deltaY/(10*g.camera.scale),u.strokeSize=Math.min(100/g.camera.scale,Math.max(.5/g.camera.scale,u.strokeSize)))});window.addEventListener("keydown",e=>{e.target===document.body&&(u.keyboard.has(e.key)||u.keyboard.set(e.key,1))});window.addEventListener("keyup",e=>{u.keyboard.delete(e.key)});let ft=0;function De(){if(Math.hypot(u.mouse.imageX-u.mouse.oldImageX,u.mouse.imageY-u.mouse.oldImageY)>.1){let t=Math.atan2(u.mouse.imageY-u.mouse.oldImageY,u.mouse.imageX-u.mouse.oldImageX)-ft;for(;t<-Math.PI;)t+=2*Math.PI;for(;t>Math.PI;)t-=2*Math.PI;ft+=t*.25}return ft}class g{static canvas=document.getElementById("canvas-main");static ctx=this.canvas.getContext("2d");static camera={x:0,xSpeed:0,y:0,ySpeed:0,scale:1,scaleSpeed:0};static resize(){const t=this.canvas.getBoundingClientRect();this.canvas.width=t.width*d.settings.resolution,this.canvas.height=t.height*d.settings.resolution,m.updateTransform(),d.settings.fps!==0&&this.update(0)}static reset(){this.camera={x:0,xSpeed:0,y:0,ySpeed:0,scale:1,scaleSpeed:0}}static update(t){const i=this.camera.x,s=this.camera.y,a=this.camera.scale;this.camera.scale*=1+this.camera.scaleSpeed*t,this.camera.scale=Math.min(500,this.camera.scale);const n=i+u.mouse.editorX/a,r=s+u.mouse.editorY/a,h=this.camera.scale/a;if(this.camera.x=n+(i-n)/h,this.camera.y=r+(s-r)/h,this.camera.x+=this.camera.xSpeed*t/this.camera.scale*d.settings.resolution,this.camera.y+=this.camera.ySpeed*t/this.camera.scale*d.settings.resolution,this.camera.xSpeed*=Math.pow(.99,t),this.camera.ySpeed*=Math.pow(.99,t),this.camera.scaleSpeed*=Math.pow(.99,t),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.imageSmoothingEnabled=!1,m.data!==null){const _=m.data.transform;if(this.ctx.drawImage(m.data.element,(_.x-this.camera.x)*this.camera.scale,(_.y-this.camera.y)*this.camera.scale,_.width*this.camera.scale,_.height*this.camera.scale),m.update(),this.ctx.drawImage(m.canvas,(_.x-this.camera.x)*this.camera.scale,(_.y-this.camera.y)*this.camera.scale,_.width*this.camera.scale,_.height*this.camera.scale),this.ctx.fillStyle="rgba(255,0,0,0.5)",this.ctx.strokeStyle="rgba(255,0,0,0.5)",u.strokeType===1&&u.startX===null&&u.startY===null){const c=De()+Math.PI/2,f=(m.data.transform.width+m.data.transform.height)*(u.strokeSize/2*.0025)*g.camera.scale,o=u.mouse.editorX+f*Math.cos(c),v=u.mouse.editorY+f*Math.sin(c),p=u.mouse.editorX+f*Math.cos(c+Math.PI),S=u.mouse.editorY+f*Math.sin(c+Math.PI);this.ctx.lineCap="butt",this.ctx.lineWidth=u.strokeSize*.25*g.camera.scale,this.ctx.moveTo(o,v),this.ctx.lineTo(p,S),this.ctx.stroke(),this.ctx.beginPath()}else if(u.strokeType===2&&u.startX===null&&u.startY===null)this.ctx.arc(u.mouse.editorX,u.mouse.editorY,(m.data.transform.width+m.data.transform.height)*(u.strokeSize/2*.0025)*this.camera.scale,0,2*Math.PI),this.ctx.fill(),this.ctx.beginPath();else if(u.strokeType===3)for(const c of u.strokePoints)this.ctx.arc((m.data.transform.x+c.x*m.data.transform.widthScale-this.camera.x)*this.camera.scale,(m.data.transform.y+c.y*m.data.transform.heightScale-this.camera.y)*this.camera.scale,5*d.settings.resolution,0,2*Math.PI),this.ctx.fill(),this.ctx.beginPath();u.saveConfirm>0&&(this.ctx.fillStyle=`rgba(255,255,255,${u.saveConfirm})`,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height))}}}window.addEventListener("load",()=>{g.resize(),window.addEventListener("resize",()=>g.resize())});g.canvas.addEventListener("contextmenu",e=>{e.preventDefault()});g.canvas.addEventListener("click",()=>{d.updateLayout({help:!1,settings:!1})});const We=()=>{const e=i=>{const s=i.substring(0,20).toLowerCase().split("");for(let a=s.length-1;a>=0;a--)"abcdefghijklmnopqrstuvwxyz0123456789".includes(s[a])||s.splice(a,1);s.length>=5&&d.updateSettings({username:s.slice(0,16).join("")})},t=i=>{g.camera.x/=d.settings.resolution,g.camera.y/=d.settings.resolution,d.updateSettings({resolution:i}),g.camera.x*=d.settings.resolution,g.camera.y*=d.settings.resolution,g.resize()};return l("div",{class:"shadow",style:{display:d.layout.settings?"block":"none",border:"0.05rem solid ",borderRadius:"0.5rem",marginRight:"var(--spacing-medium)",marginBottom:"var(--spacing-medium)",overflow:"hidden"},children:[l("h3",{class:d.settings.reduceTransparency?"container-solid-light":"container-glassy-light",style:{padding:"var(--spacing-medium)"},children:"Settings"}),l("div",{class:d.settings.reduceTransparency?"container-solid-dark":"container-glassy-dark",children:[l("div",{style:{width:"100%",height:"0.05rem",backgroundColor:"var(--color-foreground)",opacity:.1}}),l("div",{style:{padding:"var(--spacing-medium)"},children:[l("div",{style:{display:"flex",alignItems:"center",marginBottom:"var(--spacing-big)"},children:[l("p",{style:{textWrap:"nowrap",marginRight:"var(--spacing-small)"},children:"Username:"}),l("input",{value:d.settings.username,onChange:i=>e(i.target.value)})]}),l("div",{style:{display:"flex",alignItems:"center",marginBottom:"var(--spacing-tiny)"},children:[l("p",{style:{textWrap:"nowrap",marginRight:"var(--spacing-small)"},children:"FPS:"}),l("input",{type:"range",step:"10",min:"0",max:"120",value:d.settings.fps,onInput:i=>d.updateSettings({fps:parseInt(i.target.value)}),style:{marginRight:"var(--spacing-small)"}}),l("p",{children:d.settings.fps===0?"(VSync)":`(${d.settings.fps})`})]}),l("div",{style:{display:"flex",alignItems:"center",marginBottom:"var(--spacing-tiny)"},children:[l("p",{style:{textWrap:"nowrap",marginRight:"var(--spacing-small)"},children:"Resolution:"}),l("input",{type:"range",step:"0.1",min:"0.5",max:"2",value:d.settings.resolution,onInput:i=>t(parseFloat(i.target.value)),style:{marginRight:"var(--spacing-small)"}}),l("p",{children:d.settings.resolution===window.devicePixelRatio?"(Native)":`(${d.settings.resolution}x)`})]}),l("div",{style:{display:"flex",alignItems:"center",marginBottom:"var(--spacing-big)"},children:[l("p",{style:{textWrap:"nowrap",marginRight:"var(--spacing-small)"},children:"Preload Image:"}),l("input",{type:"range",step:"1",min:"0",max:"10",value:d.settings.preload,onInput:i=>d.updateSettings({preload:parseInt(i.target.value)}),style:{marginRight:"var(--spacing-small)"}}),l("p",{children:d.settings.preload===5?"(Default)":`(${d.settings.preload})`})]}),l("div",{style:{display:"flex",alignItems:"center",marginBottom:"var(--spacing-tiny)"},children:[l("p",{style:{textWrap:"nowrap",marginRight:"var(--spacing-small)"},children:"Move Speed:"}),l("input",{type:"range",step:"0.1",min:"0.5",max:"1.5",value:d.settings.moveSpeed,onInput:i=>d.updateSettings({moveSpeed:parseFloat(i.target.value)}),style:{marginRight:"var(--spacing-small)"}}),l("p",{children:d.settings.moveSpeed===1?"(Default)":`(${d.settings.moveSpeed}x)`})]}),l("div",{style:{display:"flex",alignItems:"center",marginBottom:"var(--spacing-big)"},children:[l("p",{style:{textWrap:"nowrap",marginRight:"var(--spacing-small)"},children:"Scale Speed:"}),l("input",{type:"range",step:"0.1",min:"0.5",max:"1.5",value:d.settings.scaleSpeed,onInput:i=>d.updateSettings({scaleSpeed:parseFloat(i.target.value)}),style:{marginRight:"var(--spacing-small)"}}),l("p",{children:d.settings.scaleSpeed===1?"(Default)":`(${d.settings.scaleSpeed}x)`})]}),l("div",{style:{display:"flex",alignItems:"center"},children:[l("p",{style:{textWrap:"nowrap",marginRight:"var(--spacing-small)"},children:"Reduce Transparency:"}),l("input",{type:"checkbox",checked:d.settings.reduceTransparency,onChange:i=>d.updateSettings({reduceTransparency:i.target.checked})})]})]})]})]})},je=()=>{const e=t=>{d.updateSource({value:t,display:t}),m.next()};return l("nav",{class:d.settings.reduceTransparency?"container-solid-light shadow":"container-glassy-light shadow",style:{position:"fixed",display:"flex",alignItems:"center",left:"0rem",top:"0rem",width:"100%",height:"3.5rem"},children:[l("h1",{style:{textWrap:"nowrap",marginLeft:"var(--spacing-medium)",marginRight:"var(--spacing-medium)"},children:"Dataset Editor"}),l("button",{onClick:()=>d.updateLayout({help:!d.layout.help}),style:{marginRight:"var(--spacing-medium)",cursor:"pointer"},children:"Help"}),l("button",{onClick:()=>d.updateLayout({settings:!d.layout.settings}),style:{marginRight:"var(--spacing-medium)",cursor:"pointer"},children:"Settings"}),l("div",{style:"flex: 1"}),l("select",{onChange:t=>d.updateSource({driver:t.target.value}),style:{marginRight:"var(--spacing-small)"},children:Object.keys(m.drivers).map(t=>l("option",{value:m.drivers[t].id,selected:t===d.source.driver?!0:void 0,children:m.drivers[t].name}))}),l("input",{value:d.source.display,autocomplete:"off",onChange:t=>e(t.target.value),style:{width:"7.5rem",marginRight:"var(--spacing-small)"}}),l("button",{style:{marginRight:"var(--spacing-medium)",cursor:"pointer"},children:"Entries"})]})},Fe=()=>l("div",{class:"shadow",style:{display:d.layout.help?"block":"none",border:"0.05rem solid ",borderRadius:"0.5rem",marginRight:"var(--spacing-medium)",marginBottom:"var(--spacing-medium)",overflow:"hidden"},children:[l("h3",{class:d.settings.reduceTransparency?"container-solid-light":"container-glassy-light",style:{padding:"var(--spacing-medium)"},children:"Help"}),l("div",{class:d.settings.reduceTransparency?"container-solid-dark":"container-glassy-dark",children:[l("div",{style:{width:"100%",height:"0.05rem",backgroundColor:"var(--color-foreground)",opacity:.1}}),l("div",{style:{padding:"var(--spacing-medium)"},children:[l("p",{style:{marginBottom:"var(--spacing-small)"},children:[l("span",{class:"key",style:{marginRight:"var(--spacing-tiny)"},children:"W"}),l("span",{class:"key",style:{marginRight:"var(--spacing-tiny)"},children:"A"}),l("span",{class:"key",style:{marginRight:"var(--spacing-tiny)"},children:"S"}),l("span",{class:"key",style:{marginRight:"var(--spacing-tiny)"},children:"D"}),l("span",{style:{marginRight:"var(--spacing-tiny)"},children:"to move,"}),l("span",{class:"key",style:{marginRight:"var(--spacing-tiny)"},children:"E"}),l("span",{class:"key",style:{marginRight:"var(--spacing-tiny)"},children:"Q"}),l("span",{children:"to zoom in and out."})]}),l("p",{style:{marginBottom:"var(--spacing-big)"},children:[l("span",{class:"key",style:{marginRight:"var(--spacing-tiny)"},children:"R"}),l("span",{children:"to reset the camera."})]}),l("p",{style:{marginBottom:"var(--spacing-small)"},children:[l("span",{class:"key",style:{marginRight:"var(--spacing-tiny)"},children:"1"}),l("span",{class:"key",style:{marginRight:"var(--spacing-tiny)"},children:"2"}),l("span",{class:"key",style:{marginRight:"var(--spacing-tiny)"},children:"3"}),l("span",{children:"to change the stroke type."})]}),l("p",{style:{marginBottom:"var(--spacing-small)"},children:[l("span",{class:"key",style:{marginRight:"var(--spacing-tiny)"},children:"Mouse Wheel"}),l("span",{class:"key",style:{marginRight:"var(--spacing-tiny)"},children:"+"}),l("span",{class:"key",style:{marginRight:"var(--spacing-tiny)"},children:"="}),l("span",{children:"to change the stroke size."})]}),l("p",{style:{marginBottom:"var(--spacing-big)"},children:[l("span",{class:"key",style:{marginRight:"var(--spacing-tiny)"},children:"F"}),l("span",{children:"to change the stroke opacity."})]}),l("h5",{style:{marginBottom:"var(--spacing-small)"},children:"Stroke Type 1 or 2"}),l("p",{style:{lineHeight:"var(--size-big)",marginBottom:"var(--spacing-small)"},children:[l("span",{class:"key",style:{marginRight:"var(--spacing-tiny)"},children:"Left Click"}),l("span",{children:"to draw."})]}),l("p",{style:{marginBottom:"var(--spacing-big)"},children:[l("span",{class:"key",style:{marginRight:"var(--spacing-tiny)"},children:"Right Click"}),l("span",{children:"to continue from the last stroke."})]}),l("h5",{style:{marginBottom:"var(--spacing-small)"},children:"Stroke Type 3"}),l("p",{style:{lineHeight:"var(--size-big)",marginBottom:"var(--spacing-small)"},children:[l("span",{class:"key",style:{marginRight:"var(--spacing-tiny)"},children:"Left Click"}),l("span",{children:"to add a point or move a point."})]}),l("p",{style:{marginBottom:"var(--spacing-big)"},children:[l("span",{class:"key",style:{marginRight:"var(--spacing-tiny)"},children:"Right Click"}),l("span",{children:"to complete or edit the last shape."})]}),l("p",{style:{marginBottom:"var(--spacing-small)"},children:[l("span",{class:"key",style:{marginRight:"var(--spacing-tiny)"},children:"X"}),l("span",{children:"to delete the last stroke or point."})]}),l("p",{children:[l("span",{class:"key",style:{marginRight:"var(--spacing-tiny)"},children:"Z"}),l("span",{style:{marginRight:"var(--spacing-tiny)"},children:"to skip the image,"}),l("span",{class:"key",style:{marginRight:"var(--spacing-tiny)"},children:"C"}),l("span",{children:"to submit."})]})]})]})]});It(l(Fe,{}),document.getElementById("container-help"));It(l(je,{}),document.getElementById("container-navbar"));It(l(We,{}),document.getElementById("container-settings"));let mt=performance.now();function wt(){const e=performance.now()-mt;mt=performance.now(),u.update(e),g.update(e),d.settings.fps===0?requestAnimationFrame(wt):setTimeout(wt,1e3/d.settings.fps-(performance.now()-mt))}let ve=!0;async function lt(){try{const e=await m.drivers[d.source.driver].preload(d.settings.preload);e===null?setTimeout(lt,100):(await fetch(e.url),lt())}catch{ve=!1}}window.addEventListener("load",()=>{wt(),lt(),m.next(),d.sourceSignal.subscribe(()=>{ve||lt()})});
